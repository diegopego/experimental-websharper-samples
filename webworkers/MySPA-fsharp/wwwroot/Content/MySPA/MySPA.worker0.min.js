(function(n){"use strict";Date.now||(Date.now=function(){return(new Date).getTime()});Math.trunc||(Math.trunc=function(n){return n<0?Math.ceil(n):Math.floor(n)});Object.setPrototypeOf||(Object.setPrototypeOf=function(n,t){return n.__proto__=t,n});n.WebSharper={Runtime:{Ctor:function(n,t){return n.prototype=t.prototype,n},Class:function(n,t,i){var u=n,f,r,e;if(t){u=new t;for(f in n)u[f]=n[f]}if(r=function(n){if(n)for(var t in n)this[t]=n[t]},r.prototype=u,i)for(e in i)r[e]=i[e];return r},Clone:function(n){var t={};for(var i of Object.getOwnPropertyNames(n))t[i]=n[i];return Object.setPrototypeOf(t,Object.getPrototypeOf(n)),t},NewObject:function(n){for(var i={},t=0;t<n.length;t++)i[n[t][0]]=n[t][1];return i},PrintObject:function(n){var t="{ ",i=!0;for(var r of Object.getOwnPropertyNames(n))i?i=!1:t+=", ",t+=r+" = "+n[r];return t+(i?"}":" }")},DeleteEmptyFields:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],n[r]===void 0&&delete n[r];return n},GetOptional:function(n){return n===void 0?null:{$:1,$0:n}},SetOptional:function(n,t,i){i?n[t]=i.$0:delete n[t]},SetOrDelete:function(n,t,i){i===void 0?delete n[t]:n[t]=i},Apply:function(n,t,i){return n.apply(t,i)},Bind:function(n){return function(){return n.apply(this,arguments)}},CreateFuncWithArgs:function(n){return function(){return n(Array.prototype.slice.call(arguments))}},CreateFuncWithOnlyThis:function(n){return function(){return n(this)}},CreateFuncWithThis:function(n){return function(){return n(this).apply(null,arguments)}},CreateFuncWithThisArgs:function(n){return function(){return n(this)(Array.prototype.slice.call(arguments))}},CreateFuncWithRest:function(n,t){return function(){return t(Array.prototype.slice.call(arguments,0,n).concat([Array.prototype.slice.call(arguments,n)]))}},CreateFuncWithArgsRest:function(n,t){return function(){return t([Array.prototype.slice.call(arguments,0,n),Array.prototype.slice.call(arguments,n)])}},BindDelegate:function(n,t){var i=n.bind(t);return i.$Func=n,i.$Target=t,i},CreateDelegate:function(n){if(n.length==0)return null;if(n.length==1)return n[0];var t=function(){for(var i,t=0;t<n.length;t++)i=n[t].apply(null,arguments);return i};return t.$Invokes=n,t},CombineDelegates:function(n){for(var t,i=[],r=0;r<n.length;r++)t=n[r],t&&("$Invokes"in t?i=i.concat(t.$Invokes):i.push(t));return WebSharper.Runtime.CreateDelegate(i)},DelegateEqual:function(n,t){var f,e,i,r,u;if(n===t)return!0;if(n==null||t==null||(f=n.$Invokes||[n],e=t.$Invokes||[t],f.length!=e.length))return!1;for(i=0;i<f.length;i++)if(r=f[i],u=e[i],!(r===u||"$Func"in r&&"$Func"in u&&r.$Func===u.$Func&&r.$Target==u.$Target))return!1;return!0},ThisFunc:function(n){return function(){var t=Array.prototype.slice.call(arguments);return t.unshift(this),n.apply(null,t)}},ThisFuncOut:function(n){return function(){var t=Array.prototype.slice.call(arguments);return n.apply(t.shift(),t)}},ParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat([i.slice(n)]))}},ParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(null,i.slice(0,n).concat(i[n]))}},ThisParamsFunc:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return i.unshift(this),t.apply(null,i.slice(0,n+1).concat([i.slice(n+1)]))}},ThisParamsFuncOut:function(n,t){return function(){var i=Array.prototype.slice.call(arguments);return t.apply(i.shift(),i.slice(0,n).concat(i[n]))}},Curried:function(n,t,i){return i=i||[],function(r){var u=i.concat([r===void 0?null:r]);return t==1?n.apply(null,u):t==2?function(t){return n.apply(null,u.concat([t===void 0?null:t]))}:WebSharper.Runtime.Curried(n,t-1,u)}},Curried2:function(n){return function(t){return function(i){return n(t,i)}}},Curried3:function(n){return function(t){return function(i){return function(r){return n(t,i,r)}}}},UnionByType:function(n,t,i){for(var u,f=typeof t,r=0;r<n.length;r++)if(u=n[r],typeof u=="number"){if(Array.isArray(t)&&(u==0||t.length==u))return{$:r,$0:t}}else if(u==f)return{$:r,$0:t};if(!i)throw new Error("Type not expected for creating Choice value.");},MarkResizable:function(n){return Object.defineProperty(n,"resizable",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},MarkReadOnly:function(n){return Object.defineProperty(n,"readonly",{enumerable:!1,writable:!1,configurable:!1,value:!0}),n},ScriptBasePath:"./",ScriptPath:function(n,t){return this.ScriptBasePath+(this.ScriptSkipAssemblyDir?"":n+"/")+t},OnLoad:function(n){"load"in this||(this.load=[]);this.load.push(n)},Start:function(){function n(n){for(var t=0;t<n.length;t++)n[t]()}"load"in this&&(n(this.load),this.load=[])}}};n.WebSharper.Runtime.OnLoad(function(){n.WebSharper&&WebSharper.Activator&&WebSharper.Activator.Activate&&WebSharper.Activator.Activate()});n.ignore=function(){};n.id=function(n){return n};n.fst=function(n){return n[0]};n.snd=function(n){return n[1]};n.trd=function(n){return n[2]};n.console||(n.console={count:ignore,dir:ignore,error:ignore,group:ignore,groupEnd:ignore,info:ignore,log:ignore,profile:ignore,profileEnd:ignore,time:ignore,timeEnd:ignore,trace:ignore,warn:ignore})})(self);
(function(a){"use strict";var b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;b=a.EventTarget;c=a.WindowOrWorkerGlobalScope;d=a.WorkerGlobalScope;e=a.WebSharper=a.WebSharper||{};f=e.Operators=e.Operators||{};g=a.Event;h=e.Arrays=e.Arrays||{};i=e.Concurrency=e.Concurrency||{};j=e.Strings=e.Strings||{};k=e.Obj=e.Obj||{};l=i.CT=i.CT||{};m=i.AsyncBody=i.AsyncBody||{};n=a.StartupCode$WebSharper_Main$Concurrency=a.StartupCode$WebSharper_Main$Concurrency||{};o=i.Scheduler=i.Scheduler||{};p=a.Error;q=e.OperationCanceledException=e.OperationCanceledException||{};r=e.CancellationTokenSource=e.CancellationTokenSource||{};s=a.Object;t=a.console;u=e&&e.Runtime;v=a.Date;f.FailWith=function(x){throw new p(x);};h.init=function(x,y){var z,A,B;if(x<0)f.FailWith("Negative size given.");else null;z=new a.Array(x);for(A=0,B=x-1;A<=B;A++)z[A]=y(A);return z;};h.set=function(x,y,z){h.checkBounds(x,y);x[y]=z;};h.checkBounds=function(x,y){if(y<0||y>=x.length)f.FailWith("Index was outside the bounds of the array.");};i.Start=function(x,y){var z,A;z=(A=(i.defCTS())[0],y==null?A:y.$0);i.scheduler().Fork(function(){if(!z.c)x(m.New(function(B){if(B.$==1)i.UncaughtAsyncError(B.$0);},z));});};i.Delay=function(x){return function(y){try{(x(null))(y);}catch(z){y.k({$:1,$0:z});}};};i.Bind=function(x,y){return i.checkCancel(function(z){x(m.New(function(A){var B;if(A.$==0){B=A.$0;i.scheduler().Fork(function(){try{(y(B))(z);}catch(C){z.k({$:1,$0:C});}});}else i.scheduler().Fork(function(){z.k(A);});},z.ct));});};i.Sleep=function(x){return function(y){var z,A;z=void 0;A=void 0;z=a.setTimeout(function(){A.Dispose();i.scheduler().Fork(function(){y.k({$:0,$0:null});});},x);A=i.Register(y.ct,function(){a.clearTimeout(z);i.scheduler().Fork(function(){i.cancel(y);});});};};i.Zero=function(){n.$cctor();return n.Zero;};i.defCTS=function(){n.$cctor();return n.defCTS;};i.UncaughtAsyncError=function(x){t.log("WebSharper: Uncaught asynchronous exception",x);};i.checkCancel=function(x){return function(y){if(y.ct.c)i.cancel(y);else x(y);};};i.Register=function(x,y){var z;return x===i.noneCT()?{Dispose:function(){return null;}}:(z=x.r.push(y)-1,{Dispose:function(){return h.set(x.r,z,a.ignore);}});};i.cancel=function(x){x.k({$:2,$0:new q.New(x.ct)});};i.scheduler=function(){n.$cctor();return n.scheduler;};i.noneCT=function(){n.$cctor();return n.noneCT;};i.Return=function(x){return function(y){y.k({$:0,$0:x});};};j.ToCharArray=function(x){return h.init(x.length,function(y){return x[y];});};k=e.Obj=u.Class({},null,k);k.New=u.Ctor(function(){},k);l.New=function(x,y){return{c:x,r:y};};m.New=function(x,y){return{k:x,ct:y};};n.$cctor=function(){n.$cctor=a.ignore;n.noneCT=l.New(false,[]);n.scheduler=new o.New();n.defCTS=[new r.New()];n.Zero=i.Return();n.GetCT=function(x){x.k({$:0,$0:x.ct});};};o=i.Scheduler=u.Class({Fork:function(x){var y;y=this;this.robin.push(x);if(this.idle){this.idle=false;a.setTimeout(function(){y.tick();},0);}},tick:function(){var x,y,z;y=this;z=v.now();x=true;while(x)if(this.robin.length===0){this.idle=true;x=false;}else{(this.robin.shift())();v.now()-z>40?(a.setTimeout(function(){y.tick();},0),x=false):void 0;}}},k,o);o.New=u.Ctor(function(){k.New.call(this);this.idle=true;this.robin=[];},o);q=e.OperationCanceledException=u.Class({},p,q);q.New=u.Ctor(function(x){q.New$1.call(this,"The operation was canceled.",null,x);},q);q.New$1=u.Ctor(function(x,y,z){this.message=x;this.inner=y;s.setPrototypeOf(this,q.prototype);this.ct=z;},q);r=e.CancellationTokenSource=u.Class({},k,r);r.New=u.Ctor(function(){k.New.call(this);this.c=false;this.pending=null;this.r=[];this.init=1;},r);function w(x){var y;y=null;return i.Delay(function(){return i.Bind(i.Sleep(1000),function(){a.postMessage("Hello, main thread. Here is your reversed message: "+a.String(j.ToCharArray(x.data).slice().reverse().join("")));return i.Zero();});});}t.log("echoWorker says: echoWorker has been initialized.");a.postMessage("Hello, main thread. This happens once during echoWorker initialization.");a.onmessage=function(x){t.log("echoWorker says: Received message from main thread: "+a.String(x.data));return i.Start(w(x),null);};}(self));


if (typeof WebSharper !=='undefined') {
  WebSharper.Runtime.ScriptSkipAssemblyDir = true;
  WebSharper.Runtime.Start();
}
